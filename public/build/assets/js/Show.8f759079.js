var e=(e,t,r)=>new Promise(((a,s)=>{var i=e=>{try{d(r.next(e))}catch(t){s(t)}},n=e=>{try{d(r.throw(e))}catch(t){s(t)}},d=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);d((r=r.apply(e,t)).next())}));import{j as t,c as r}from"./app.3894a3a4.js";import{r as a,G as s,S as i,x as n,b as d}from"./vendor.463d2c8a.js";import{C as o,t as l}from"./CinematicLayout.b5c7e729.js";import{m as c}from"./motion.6f439a0f.js";import"./ResponsiveNavLink.c80c41cd.js";import"./DarkModeToggle.75e87d05.js";const m=({product:m,relatedProducts:x})=>{const[h,p]=a.useState(1),[u,g]=a.useState(m.image),[k,y]=a.useState(m.is_liked||!1),[v,j]=a.useState([]),[w,b]=a.useState(!1),[f,N]=a.useState(null),[C,_]=a.useState({}),S={};x.forEach((e=>{C[e.id]||(C[e.id]=1),S[e.id]=s({product_id:e.id,quantity:C[e.id]||1})})),a.useEffect((()=>{const e=[];if(m.image&&e.push(m.image),m.images&&m.images.length>0)m.images.forEach((t=>{t.url&&e.push(t.url)}));else if(m.gallery)try{if("string"==typeof m.gallery){const t=JSON.parse(m.gallery);Array.isArray(t)&&t.forEach((t=>e.push(t)))}else Array.isArray(m.gallery)&&m.gallery.forEach((t=>e.push(t)))}catch(t){}j(e),e.length>0&&g(e[0])}),[m]);const{setData:L}=s({product_id:m.id,quantity:h});a.useEffect((()=>{L("quantity",h)}),[h]);const M={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return t.jsxs(o,{children:[t.jsx(i,{title:`${m.name} - ${l("app.title")}`}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsx("nav",{className:"flex mb-8","aria-label":"Breadcrumb",children:t.jsxs("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[t.jsx("li",{className:"inline-flex items-center",children:t.jsx(n,{href:route("home"),className:"text-gray-500 dark:text-gray-300 hover:text-pink-600 dark:hover:text-pink-400",children:l("common.home")})}),t.jsx("li",{children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),t.jsx(n,{href:route("products.index"),className:"ml-1 text-gray-500 dark:text-gray-300 hover:text-pink-600 dark:hover:text-pink-400 md:ml-2",children:l("products.title")})]})}),t.jsx("li",{"aria-current":"page",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),t.jsx("span",{className:"ml-1 text-gray-500 dark:text-gray-300 md:ml-2",children:m.name})]})})]})}),t.jsxs("div",{className:"lg:grid lg:grid-cols-2 lg:gap-12",children:[t.jsxs(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:[t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-white dark:bg-cinematic-800 border border-gray-200 dark:border-cinematic-700",children:t.jsx(c.img,{initial:{opacity:0},animate:{opacity:1},src:u||"/assets/default-product.png",alt:m.name,className:"h-full w-full object-cover object-center"},u)})}),v.length>0&&t.jsx("div",{className:"grid grid-cols-4 gap-2",children:v.map(((e,r)=>t.jsx("div",{onClick:()=>g(e),className:"cursor-pointer rounded-md overflow-hidden bg-white dark:bg-cinematic-800 border border-gray-200 dark:border-cinematic-700 "+(u===e?"ring-2 ring-pink-500":""),children:t.jsx("img",{src:e,alt:`${m.name} ${r+1}`,className:"h-20 w-full object-cover object-center"})},r)))})]}),t.jsxs(c.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},children:[t.jsx("div",{className:"mb-2",children:t.jsx(n,{href:route("products.index",{category:m.category_id}),className:"text-sm font-medium text-pink-600 dark:text-pink-400 hover:text-pink-800 dark:hover:text-pink-300",children:m.category.name})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:m.name}),t.jsx("div",{className:"mb-6",children:m.sale_price?t.jsxs("div",{className:"flex items-center",children:[t.jsxs("span",{className:"text-2xl font-bold text-pink-600 dark:text-pink-400",children:["$",m.sale_price]}),t.jsxs("span",{className:"ml-3 text-lg text-gray-500 dark:text-gray-400 line-through",children:["$",m.price]}),t.jsxs("span",{className:"ml-3 px-2 py-1 bg-pink-100 dark:bg-pink-900/30 text-pink-800 dark:text-pink-300 text-xs font-medium rounded",children:[Math.round(100*(1-m.sale_price/m.price)),"% OFF"]})]}):t.jsxs("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",m.price]})}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:l("products.description")}),t.jsx("div",{className:"prose prose-sm text-gray-600 dark:text-gray-300",children:t.jsx("p",{children:m.description})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:l("products.availability")}),t.jsx("p",{className:"text-sm "+(m.stock>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:m.stock>0?l("products.in_stock",{count:m.stock}):l("products.out_of_stock")})]}),t.jsxs("form",{onSubmit:t=>e(void 0,null,(function*(){t.preventDefault(),b(!0);try{const e=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),t=yield fetch(route("cart.add"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":e,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({product_id:m.id,quantity:h})}),a=yield t.json();a.success?(r.success(a.message||"Product added to cart successfully"),a.count&&window.dispatchEvent(new CustomEvent("cart-updated",{detail:{count:parseInt(a.count)}}))):r.error(a.message||"Failed to add product to cart"),setTimeout((()=>{b(!1)}),1e3)}catch(e){r.error("Failed to add product to cart"),b(!1)}})),children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:l("products.quantity")}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("button",{type:"button",onClick:()=>{h>1&&p(h-1)},className:"p-2 border border-gray-300 dark:border-cinematic-600 rounded-l-md bg-gray-100 dark:bg-cinematic-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-cinematic-600",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),t.jsx("input",{type:"number",min:"1",max:m.stock,value:h,onChange:e=>p(parseInt(e.target.value)),className:"p-2 w-16 text-center border-t border-b border-gray-300 dark:border-cinematic-600 bg-white dark:bg-cinematic-700 text-gray-900 dark:text-white",readOnly:!0}),t.jsx("button",{type:"button",onClick:()=>{h<m.stock&&p(h+1)},className:"p-2 border border-gray-300 dark:border-cinematic-600 rounded-r-md bg-gray-100 dark:bg-cinematic-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-cinematic-600",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx(c.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:w||0===m.stock,className:"flex-1 py-3 px-6 rounded-md text-white font-medium "+(0===m.stock?"bg-gray-400 dark:bg-gray-600 cursor-not-allowed":w?"bg-gradient-to-r from-pink-500 to-purple-600 shadow-lg shadow-pink-500/20 dark:shadow-pink-700/30":"bg-pink-600 dark:bg-pink-700 hover:bg-pink-700 dark:hover:bg-pink-600"),children:w?t.jsxs("span",{className:"flex items-center justify-center",children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l("common.adding")]}):l("cart.add_to_cart")}),t.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:()=>{y(!k),d.post(route("products.toggle-like",m.id)).then((e=>{y(e.data.is_liked)})).catch((e=>{y(!k),e.response&&401===e.response.status&&(window.location.href=route("login"))}))},className:"p-3 rounded-md border "+(k?"border-pink-500 bg-pink-50 dark:bg-pink-900/20 text-pink-600 dark:text-pink-400":"border-gray-300 dark:border-cinematic-600 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-cinematic-700"),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:k?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]})]})]})]}),x.length>0&&t.jsxs("section",{className:"mt-16",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-8",children:l("products.related_products")}),t.jsx(c.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",whileInView:"show",viewport:{once:!0},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((a=>{var s;return t.jsx(c.div,{variants:M,children:t.jsx(n,{href:route("products.show",a.slug),children:t.jsxs("div",{className:"group bg-white dark:bg-cinematic-800 rounded-lg overflow-hidden shadow-md dark:shadow-soft hover:shadow-xl dark:hover:shadow-xl transition-shadow duration-300 border border-gray-200 dark:border-cinematic-700",children:[t.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden",children:t.jsx("img",{src:(null==(s=a.images[0])?void 0:s.url)||"/assets/default-product_1.png",alt:a.name,className:"h-60 w-full object-cover object-center group-hover:scale-105 transition-transform duration-300"})}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.category.name}),t.jsx("p",{className:"mt-1 text-lg font-medium text-gray-900 dark:text-white",children:a.name}),t.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[t.jsx("div",{children:a.sale_price?t.jsxs("div",{className:"flex items-center",children:[t.jsxs("span",{className:"text-lg font-bold text-pink-600 dark:text-pink-400",children:["$",a.sale_price]}),t.jsxs("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400 line-through",children:["$",a.price]})]}):t.jsxs("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",a.price]})}),t.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t=>{var s;t.preventDefault(),t.stopPropagation(),s=a.id,e(void 0,null,(function*(){N(s);try{const e=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),t=yield fetch(route("cart.add"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":e,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({product_id:s,quantity:C[s]||1})}),a=yield t.json();a.success?(r.success(a.message||"Product added to cart successfully"),a.count&&window.dispatchEvent(new CustomEvent("cart-updated",{detail:{count:parseInt(a.count)}}))):r.error(a.message||"Failed to add product to cart"),setTimeout((()=>{N(null)}),1e3)}catch(e){r.error("Failed to add product to cart"),N(null)}}))},disabled:f===a.id,className:`p-2 rounded-full ${f===a.id?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg shadow-pink-500/20 dark:shadow-pink-700/30":"bg-pink-100 dark:bg-pink-900/30 text-pink-600 dark:text-pink-400 hover:bg-pink-200 dark:hover:bg-pink-800/40"} transition-all duration-300 relative overflow-hidden`,children:f===a.id?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx(c.div,{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-r from-pink-500 to-purple-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})})})]})]})]})})},a.id)}))})]})]})]})};export{m as default};
