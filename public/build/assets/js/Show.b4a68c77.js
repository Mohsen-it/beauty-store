var e=(e,t,r)=>new Promise(((a,s)=>{var i=e=>{try{d(r.next(e))}catch(t){s(t)}},l=e=>{try{d(r.throw(e))}catch(t){s(t)}},d=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,l);d((r=r.apply(e,t)).next())}));import{j as t,c as r}from"./app.fda8dbdd.js";import{r as a,G as s,S as i,x as l,b as d}from"./vendor.463d2c8a.js";import{C as o,t as n}from"./CinematicLayout.8983ab1e.js";import{g as c}from"./csrf.4b07ff0a.js";import{m}from"./motion.6f439a0f.js";import"./ResponsiveNavLink.fe2ebe50.js";import"./DarkModeToggle.92f019eb.js";const h=({product:h,relatedProducts:x})=>{const[p,g]=a.useState(1),[u,k]=a.useState(h.image_url),[v,y]=a.useState(h.is_liked||!1),[w,j]=a.useState([]),[b,f]=a.useState(!1),[N,_]=a.useState(null),[C,$]=a.useState({}),S={};x.forEach((e=>{C[e.id]||(C[e.id]=1),S[e.id]=s({product_id:e.id,quantity:C[e.id]||1})})),a.useEffect((()=>{const e=[];if(h.image_url&&e.push(h.image_url),h.images&&h.images.length>0)h.images.forEach((t=>{if(t.image_url)e.push(t.image_url);else if(t.url)if(t.url.startsWith("http://")||t.url.startsWith("https://"))e.push(t.url);else{const r=t.url.startsWith("storage/")?t.url:`storage/${t.url.replace(/^\//,"")}`;e.push(`/${r}?v=${(new Date).getTime()}`)}}));else if(h.gallery)try{if("string"==typeof h.gallery){const t=JSON.parse(h.gallery);Array.isArray(t)&&t.forEach((t=>e.push(t)))}else Array.isArray(h.gallery)&&h.gallery.forEach((t=>e.push(t)))}catch(t){}j(e),e.length>0&&k(e[0])}),[h]);const{setData:L}=s({product_id:h.id,quantity:p});a.useEffect((()=>{L("quantity",p)}),[p]);const M={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return t.jsxs(o,{children:[t.jsx(i,{title:`${h.name} - ${n("app.title")}`}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsx("nav",{className:"flex mb-8","aria-label":"Breadcrumb",children:t.jsxs("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[t.jsx("li",{className:"inline-flex items-center",children:t.jsx(l,{href:route("home"),className:"text-gray-500 dark:text-gray-300 hover:text-pink-600 dark:hover:text-pink-400",children:n("common.home")})}),t.jsx("li",{children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),t.jsx(l,{href:route("products.index"),className:"ml-1 text-gray-500 dark:text-gray-300 hover:text-pink-600 dark:hover:text-pink-400 md:ml-2",children:n("products.title")})]})}),t.jsx("li",{"aria-current":"page",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),t.jsx("span",{className:"ml-1 text-gray-500 dark:text-gray-300 md:ml-2",children:h.name})]})})]})}),t.jsxs("div",{className:"lg:grid lg:grid-cols-2 lg:gap-12",children:[t.jsxs(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:[t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-white dark:bg-cinematic-800 border border-gray-200 dark:border-cinematic-700",children:t.jsx(m.img,{initial:{opacity:0},animate:{opacity:1},src:u||"/assets/default-product.png",alt:h.name,className:"h-full w-full object-cover object-center"},u)})}),w.length>0&&t.jsx("div",{className:"grid grid-cols-4 gap-2",children:w.map(((e,r)=>t.jsx("div",{onClick:()=>k(e),className:"cursor-pointer rounded-md overflow-hidden bg-white dark:bg-cinematic-800 border border-gray-200 dark:border-cinematic-700 "+(u===e?"ring-2 ring-pink-500":""),children:t.jsx("img",{src:e,alt:`${h.name} ${r+1}`,className:"h-20 w-full object-cover object-center"})},r)))})]}),t.jsxs(m.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},children:[t.jsx("div",{className:"mb-2",children:t.jsx(l,{href:route("products.index",{category:h.category_id}),className:"text-sm font-medium text-pink-600 dark:text-pink-400 hover:text-pink-800 dark:hover:text-pink-300",children:h.category.name})}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:h.name}),t.jsx("div",{className:"mb-6",children:h.sale_price?t.jsxs("div",{className:"flex items-center",children:[t.jsxs("span",{className:"text-2xl font-bold text-pink-600 dark:text-pink-400",children:["$",h.sale_price]}),t.jsxs("span",{className:"ml-3 text-lg text-gray-500 dark:text-gray-400 line-through",children:["$",h.price]}),t.jsxs("span",{className:"ml-3 px-2 py-1 bg-pink-100 dark:bg-pink-900/30 text-pink-800 dark:text-pink-300 text-xs font-medium rounded",children:[Math.round(100*(1-h.sale_price/h.price)),"% OFF"]})]}):t.jsxs("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",h.price]})}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("products.description")}),t.jsx("div",{className:"prose prose-sm text-gray-600 dark:text-gray-300",children:t.jsx("p",{children:h.description})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("products.availability")}),t.jsx("p",{className:"text-sm "+(h.stock>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:h.stock>0?n("products.in_stock",{count:h.stock}):n("products.out_of_stock")})]}),t.jsxs("form",{onSubmit:t=>e(void 0,null,(function*(){t.preventDefault(),f(!0);try{const e=c(),t=yield fetch(route("cart.add"),{method:"POST",headers:e,body:JSON.stringify({product_id:h.id,quantity:p})}),a=yield t.json();a.success?(r.success(a.message||"Product added to cart successfully"),a.count&&window.dispatchEvent(new CustomEvent("cart-updated",{detail:{count:parseInt(a.count)}}))):r.error(a.message||"Failed to add product to cart"),setTimeout((()=>{f(!1)}),1e3)}catch(e){r.error("Failed to add product to cart"),f(!1)}})),children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:n("products.quantity")}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("button",{type:"button",onClick:()=>{p>1&&g(p-1)},className:"p-2 border border-gray-300 dark:border-cinematic-600 rounded-l-md bg-gray-100 dark:bg-cinematic-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-cinematic-600",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),t.jsx("input",{type:"number",min:"1",max:h.stock,value:p,onChange:e=>g(parseInt(e.target.value)),className:"p-2 w-16 text-center border-t border-b border-gray-300 dark:border-cinematic-600 bg-white dark:bg-cinematic-700 text-gray-900 dark:text-white",readOnly:!0}),t.jsx("button",{type:"button",onClick:()=>{p<h.stock&&g(p+1)},className:"p-2 border border-gray-300 dark:border-cinematic-600 rounded-r-md bg-gray-100 dark:bg-cinematic-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-cinematic-600",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx(m.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:b||0===h.stock,className:"flex-1 py-3 px-6 rounded-md text-white font-medium "+(0===h.stock?"bg-gray-400 dark:bg-gray-600 cursor-not-allowed":b?"bg-gradient-to-r from-pink-500 to-purple-600 shadow-lg shadow-pink-500/20 dark:shadow-pink-700/30":"bg-pink-600 dark:bg-pink-700 hover:bg-pink-700 dark:hover:bg-pink-600"),children:b?t.jsxs("span",{className:"flex items-center justify-center",children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n("common.adding")]}):n("cart.add_to_cart")}),t.jsx(m.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:()=>{y(!v),d.post(route("products.toggle-like",h.id)).then((e=>{y(e.data.is_liked)})).catch((e=>{y(!v),e.response&&401===e.response.status&&(window.location.href=route("login"))}))},className:"p-3 rounded-md border "+(v?"border-pink-500 bg-pink-50 dark:bg-pink-900/20 text-pink-600 dark:text-pink-400":"border-gray-300 dark:border-cinematic-600 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-cinematic-700"),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:v?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]})]})]})]}),x.length>0&&t.jsxs("section",{className:"mt-16",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-8",children:n("products.related_products")}),t.jsx(m.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",whileInView:"show",viewport:{once:!0},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((a=>{var s,i;return t.jsx(m.div,{variants:M,children:t.jsx(l,{href:route("products.show",a.slug),children:t.jsxs("div",{className:"group bg-white dark:bg-cinematic-800 rounded-lg overflow-hidden shadow-md dark:shadow-soft hover:shadow-xl dark:hover:shadow-xl transition-shadow duration-300 border border-gray-200 dark:border-cinematic-700",children:[t.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden",children:t.jsx("img",{src:a.images&&a.images.length>0?(null==(s=a.images[0])?void 0:s.image_url)?a.images[0].image_url:(null==(i=a.images[0])?void 0:i.url)?a.images[0].url.startsWith("http://")||a.images[0].url.startsWith("https://")?a.images[0].url:a.images[0].url.startsWith("storage/")?`/${a.images[0].url}?v=${(new Date).getTime()}`:`/storage/${a.images[0].url.replace(/^\//,"")}?v=${(new Date).getTime()}`:"/assets/default-product_1.png":a.image_url?a.image_url:"/assets/default-product_1.png",alt:a.name,className:"h-60 w-full object-cover object-center group-hover:scale-105 transition-transform duration-300"})}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.category.name}),t.jsx("p",{className:"mt-1 text-lg font-medium text-gray-900 dark:text-white",children:a.name}),t.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[t.jsx("div",{children:a.sale_price?t.jsxs("div",{className:"flex items-center",children:[t.jsxs("span",{className:"text-lg font-bold text-pink-600 dark:text-pink-400",children:["$",a.sale_price]}),t.jsxs("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400 line-through",children:["$",a.price]})]}):t.jsxs("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["$",a.price]})}),t.jsx(m.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t=>{var s;t.preventDefault(),t.stopPropagation(),s=a.id,e(void 0,null,(function*(){_(s);try{const e=c(),t=yield fetch(route("cart.add"),{method:"POST",headers:e,body:JSON.stringify({product_id:s,quantity:C[s]||1})}),a=yield t.json();a.success?(r.success(a.message||"Product added to cart successfully"),a.count&&window.dispatchEvent(new CustomEvent("cart-updated",{detail:{count:parseInt(a.count)}}))):r.error(a.message||"Failed to add product to cart"),setTimeout((()=>{_(null)}),1e3)}catch(e){r.error("Failed to add product to cart"),_(null)}}))},disabled:N===a.id,className:`p-2 rounded-full ${N===a.id?"bg-gradient-to-r from-pink-500 to-purple-600 text-white shadow-lg shadow-pink-500/20 dark:shadow-pink-700/30":"bg-pink-100 dark:bg-pink-900/30 text-pink-600 dark:text-pink-400 hover:bg-pink-200 dark:hover:bg-pink-800/40"} transition-all duration-300 relative overflow-hidden`,children:N===a.id?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx(m.div,{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-r from-pink-500 to-purple-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}):t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})})})]})]})]})})},a.id)}))})]})]})]})};export{h as default};
