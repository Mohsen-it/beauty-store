var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(r,t,a)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a;import{j as n,c as d}from"./app.3866ea9a.js";import{G as l,r as c,S as m,A as p}from"./vendor.463d2c8a.js";import{A as u}from"./AdminLayout.bc54e68e.js";import{r as g,p as x,a as f,b,c as h,F as k}from"./filepond-plugin-file-validate-size.esm.bbf43fa4.js";import{m as y}from"./motion.6f439a0f.js";import"./DarkModeToggle.15cc3f6a.js";g(x,f,b,h);const v=({category:e=null,categories:g,errors:x})=>{var f;const b=!!e,{data:h,setData:v,post:j,processing:w,errors:N,clearErrors:_}=l({name:(null==e?void 0:e.name)||"",slug:(null==e?void 0:e.slug)||"",description:(null==e?void 0:e.description)||"",parent_id:(null==e?void 0:e.parent_id)||"",order:(null==e?void 0:e.order)||0,active:null==(f=null==e?void 0:e.is_active)||f}),[C,F]=c.useState([]),[D,P]=c.useState(!1);c.useEffect((()=>{}),[x]),c.useEffect((()=>{b&&e&&e.image_url?(F([{source:e.image_url,options:{type:"local",file:{name:e.image_url.split("/").pop()},metadata:{poster:`/build/storage/${e.image_url}`,relativePath:e.image_url}}}]),P(!1)):b||(F([]),P(!1))}),[b,e]);const O=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),S=(()=>{if(!g)return[];if(!b)return g;const r=(e,t)=>{const a=t.filter((r=>r.parent_id===e));let i=[e];return a.forEach((e=>{i=[...i,...r(e.id,t)]})),i},t=r(e.id,g);return g.filter((e=>!t.includes(e.id)))})();return n.jsxs(u,{title:b?"Edit Category":"Create New Category",children:[n.jsx(m,{title:b?"Edit Category":"Create New Category"}),n.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white dark:bg-cinematic-800 shadow-md dark:shadow-soft rounded-lg overflow-hidden border border-cinematic-200 dark:border-cinematic-700",children:n.jsx("div",{className:"p-6",children:n.jsxs("form",{onSubmit:r=>{r.preventDefault(),_();const t=new FormData;for(const e in h)h.hasOwnProperty(e)&&("boolean"==typeof h[e]?t.append(e,h[e]?"1":"0"):t.append(e,h[e]));C.length>0&&C[0].file instanceof File?t.append("image_file",C[0].file,C[0].file.name):b&&D&&t.append("remove_image","1");const a={forceFormData:!0,onSuccess:()=>{d.success(b?"Category updated successfully":"Category created successfully")},onError:e=>{d.error(b?"Failed to update category":"Failed to create category"),Object.keys(e).length>0&&Object.values(e).forEach((e=>{d.error(e)}))},preserveScroll:!0,preserveState:!0};b?(t.append("_method","PUT"),p.post(route("admin.categories.update",e.id),t,a)):p.post(route("admin.categories.store"),t,a)},children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-cinematic-300",children:"Category Name *"}),n.jsx("input",{type:"text",id:"name",value:h.name,onChange:e=>{const n=e.target.value;v((e=>{return d=((e,r)=>{for(var t in r||(r={}))i.call(r,t)&&s(e,t,r[t]);if(a)for(var t of a(r))o.call(r,t)&&s(e,t,r[t]);return e})({},e),l={name:n,slug:O(n)},r(d,t(l));var d,l}))},className:"mt-1 block w-full rounded-md border-gray-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-pink-500 focus:ring-pink-500",required:!0}),N.name&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:N.name})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700 dark:text-cinematic-300",children:"Slug *"}),n.jsx("input",{type:"text",id:"slug",value:h.slug,onChange:e=>v("slug",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-pink-500 focus:ring-pink-500",required:!0}),N.slug&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:N.slug})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-cinematic-300",children:"Description"}),n.jsx("textarea",{id:"description",value:h.description,onChange:e=>v("description",e.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-pink-500 focus:ring-pink-500"}),N.description&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:N.description})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-cinematic-300 mb-2",children:"Category Image (Max 2MB, JPG/PNG/GIF)"}),n.jsx("div",{className:"filepond-dark-theme",children:n.jsx(k,{files:C,onupdatefiles:F,allowMultiple:!1,maxFiles:1,maxFileSize:"2MB",name:"image_file",labelIdle:'Drag & Drop your image or <span class="filepond--label-action">Browse</span>',acceptedFileTypes:["image/png","image/jpeg","image/gif"],fileValidateTypeLabelExpectedTypes:"Expects PNG, JPG, or GIF",labelMaxFileSizeExceeded:"File is too large",labelMaxFileSize:"Maximum file size is {filesize}",credits:!1,imagePreviewHeight:170,stylePanelLayout:"compact"})}),b&&(null==e?void 0:e.image_url)&&C.length>0&&!(C[0].file instanceof File)&&n.jsx("div",{className:"mt-2",children:n.jsxs("label",{htmlFor:"remove_image_checkbox",className:"flex items-center text-sm text-gray-700 dark:text-cinematic-300",children:[n.jsx("input",{type:"checkbox",id:"remove_image_checkbox",checked:D,onChange:e=>{P(e.target.checked),e.target.checked&&F([])},className:"mr-2 h-4 w-4 text-pink-600 focus:ring-pink-500 border-gray-300 dark:border-cinematic-600 rounded dark:bg-cinematic-700"}),"Remove current image"]})}),N.image_file&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:N.image_file})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"parent_id",className:"block text-sm font-medium text-gray-700 dark:text-cinematic-300",children:"Parent Category"}),n.jsxs("select",{id:"parent_id",value:h.parent_id,onChange:e=>v("parent_id",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-pink-500 focus:ring-pink-500",children:[n.jsx("option",{value:"",children:"None (Top Level)"}),S.map((e=>n.jsx("option",{value:e.id,children:e.name},e.id)))]}),N.parent_id&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:N.parent_id})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"order",className:"block text-sm font-medium text-gray-700 dark:text-cinematic-300",children:"Display Order"}),n.jsx("input",{type:"number",id:"order",value:h.order,onChange:e=>v("order",e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-pink-500 focus:ring-pink-500",min:"0"}),N.order&&n.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:N.order}),n.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-cinematic-400",children:"Categories are displayed in ascending order (lower numbers first)."})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{id:"is_active",type:"checkbox",checked:h.is_active,onChange:e=>v("is_active",e.target.checked),className:"h-4 w-4 text-pink-600 focus:ring-pink-500 border-gray-300 dark:border-cinematic-600 rounded dark:bg-cinematic-700 dark:focus:ring-offset-cinematic-800"}),n.jsx("label",{htmlFor:"active",className:"ml-2 block text-sm text-gray-700 dark:text-cinematic-300",children:"Active"})]})]}),n.jsxs("div",{className:"mt-8 flex justify-end",children:[n.jsx("button",{type:"button",onClick:()=>p.get(route("admin.categories.index")),className:"mr-3 px-4 py-2 border border-gray-300 dark:border-cinematic-500 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-cinematic-300 bg-white dark:bg-cinematic-700 hover:bg-gray-50 dark:hover:bg-cinematic-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 dark:focus:ring-offset-cinematic-800",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:w,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-pink-600 hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 dark:bg-pink-700 dark:hover:bg-pink-600 dark:focus:ring-offset-cinematic-800 disabled:opacity-50",children:w?"Saving...":b?"Update Category":"Create Category"})]})]})})}),n.jsx("style",{jsx:!0,global:!0,children:"\n        .filepond--panel-root {\n            background-color: #374151;\n            border: 1px dashed #4B5563;\n        }\n        .filepond--drop-label label {\n            color: #D1D5DB;\n        }\n        .filepond--label-action {\n            text-decoration-color: #9CA3AF;\n        }\n        .filepond--file-action-button {\n            color: #D1D5DB;\n        }\n        .filepond--file-info-main, .filepond--file-info-sub {\n            color: #D1D5DB;\n        }\n        .filepond--item-panel {\n            background-color: #4B5563;\n        }\n      "})]})};export{v as default};
