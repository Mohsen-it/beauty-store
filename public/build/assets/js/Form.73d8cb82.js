var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;import{j as d,c as l}from"./app.bdfb876e.js";import{G as n,r as o,S as m,A as p}from"./vendor.463d2c8a.js";import{A as u}from"./AdminLayout.9ce4ef2e.js";import{r as x,p as g,a as f,b as h,c as b,F as k}from"./filepond-plugin-file-validate-size.esm.bbf43fa4.js";import{m as j}from"./motion.6f439a0f.js";import"./DarkModeToggle.91205198.js";x(g,f,h,b);const y=({product:e=null,categories:x,errors:g})=>{var f;const h=!!e,{data:b,setData:y,post:v,processing:N,errors:w,clearErrors:_,transform:P}=n({name:(null==e?void 0:e.name)||"",slug:(null==e?void 0:e.slug)||"",description:(null==e?void 0:e.description)||"",price:(null==e?void 0:e.price)||"",sale_price:(null==e?void 0:e.sale_price)||"",category_id:(null==e?void 0:e.category_id)||"",stock:(null==e?void 0:e.stock)||0,featured:(null==e?void 0:e.featured)||!1,is_active:null==(f=null==e?void 0:e.is_active)||f}),[F,C]=o.useState([]);o.useEffect((()=>{}),[g]),o.useEffect((()=>{if(h&&e&&e.image_data&&Array.isArray(e.image_data)&&e.image_data.length>0){const t=e.image_data.map((e=>{if(!e||!e.url)return null;const t=e.url,a=t.startsWith("/")?t.substring(1):t,r=e.image_url||`/build/storage/${a}`,i=t.split("/").pop(),s=i.split(".").pop().toLowerCase();let c="application/octet-stream";return["jpg","jpeg"].includes(s)?c="image/jpeg":"png"===s?c="image/png":"gif"===s&&(c="image/gif"),{source:t,options:{type:"local",file:{name:i,type:c},metadata:{poster:r,relativePath:t,imageId:e.id}}}})).filter((e=>null!==e));t.length>0?C(t):C([])}else if(h&&e&&e.images&&Array.isArray(e.images)&&e.images.length>0){const t=e.images.map((e=>{if("string"!=typeof e||""===e.trim())return null;const t=`/build/storage/${e.startsWith("/")?e.substring(1):e}`,a=e.split("/").pop(),r=a.split(".").pop().toLowerCase();let i="application/octet-stream";return["jpg","jpeg"].includes(r)?i="image/jpeg":"png"===r?i="image/png":"gif"===r&&(i="image/gif"),{source:e,options:{type:"local",file:{name:a,type:i},metadata:{poster:t,relativePath:e}}}})).filter((e=>null!==e));t.length>0?C(t):C([])}else C([])}),[h,e]);const D=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"");return d.jsxs(u,{title:h?"Edit Product":"Create New Product",children:[d.jsx(m,{title:h?"Edit Product":"Create New Product"}),d.jsx(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white dark:bg-cinematic-800 shadow-md dark:shadow-soft rounded-lg overflow-hidden border border-cinematic-200 dark:border-cinematic-700",children:d.jsx("div",{className:"p-6",children:d.jsxs("form",{onSubmit:t=>{t.preventDefault(),_();const a=new FormData;for(const e in b)b.hasOwnProperty(e)&&("boolean"==typeof b[e]?a.append(e,b[e]?"1":"0"):a.append(e,b[e]));F.forEach((e=>{e.file instanceof File&&a.append("images[]",e.file,e.file.name)}));const r={forceFormData:!0,onSuccess:()=>{l.success(h?"Product updated successfully":"Product created successfully")},onError:e=>{l.error(h?"Failed to update product":"Failed to create product"),Object.keys(e).length>0&&Object.values(e).forEach((e=>{l.error(e)}))},preserveScroll:!0,preserveState:!0};if(h){F.filter((e=>!(e.file instanceof File))).map((e=>{const t=e.getMetadata("imageId");return t?{id:t,path:e.getMetadata("relativePath")}:{path:e.getMetadata("relativePath")}})).filter((e=>e.id||e.path)).forEach((e=>{e.id&&a.append("existing_image_ids[]",e.id),e.path&&a.append("existing_images[]",e.path)})),a.append("_method","PUT"),p.post(route("admin.products.update",e.id),a,r)}else p.post(route("admin.products.store"),a,r)},children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Product Name *"}),d.jsx("input",{type:"text",id:"name",value:b.name,onChange:e=>{const d=e.target.value;y((e=>{return l=((e,t)=>{for(var a in t||(t={}))i.call(t,a)&&c(e,a,t[a]);if(r)for(var a of r(t))s.call(t,a)&&c(e,a,t[a]);return e})({},e),n={name:d,slug:D(d)},t(l,a(n));var l,n}))},className:"mt-1 block w-full rounded-md border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0}),w.name&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.name})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Slug *"}),d.jsx("input",{type:"text",id:"slug",value:b.slug,onChange:e=>y("slug",e.target.value),className:"mt-1 block w-full rounded-md border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0}),w.slug&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.slug})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"category_id",className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Category *"}),d.jsxs("select",{id:"category_id",value:b.category_id,onChange:e=>y("category_id",e.target.value),className:"mt-1 block w-full rounded-md border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0,children:[d.jsx("option",{value:"",className:"text-cinematic-500",children:"Select a category"}),x.map((e=>d.jsx("option",{value:e.id,children:e.name},e.id)))]}),w.category_id&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.category_id})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Regular Price"}),d.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx("span",{className:"text-cinematic-500 dark:text-cinematic-400 sm:text-sm",children:"$"})}),d.jsx("input",{type:"number",id:"price",value:b.price,onChange:e=>y("price",e.target.value),className:"pl-7 block w-full rounded-md border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500",step:"0.01",min:"0",required:!0})]}),w.price&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.price})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"sale_price",className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Sale Price"}),d.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d.jsx("span",{className:"text-cinematic-500 dark:text-cinematic-400 sm:text-sm",children:"$"})}),d.jsx("input",{type:"number",id:"sale_price",value:b.sale_price,onChange:e=>y("sale_price",e.target.value),className:"pl-7 block w-full rounded-md border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500",step:"0.01",min:"0"})]}),w.sale_price&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.sale_price})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"stock",className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Stock Quantity *"}),d.jsx("input",{type:"number",id:"stock",value:b.stock,onChange:e=>y("stock",e.target.value),className:"mt-1 block w-full rounded-md border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500",min:"0",required:!0}),w.stock&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.stock})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Description"}),d.jsx("textarea",{id:"description",value:b.description,onChange:e=>y("description",e.target.value),rows:4,className:"mt-1 block w-full rounded-md border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 dark:text-white shadow-sm focus:border-primary-500 focus:ring-primary-500"}),w.description&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.description})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-cinematic-700 dark:text-cinematic-300",children:"Product Images (Max 5, 2MB each, JPG/PNG/GIF)"}),d.jsx("div",{className:"mt-1 filepond-dark",children:d.jsx(k,{files:F,onupdatefiles:C,allowMultiple:!0,maxFiles:5,maxFileSize:"2MB",name:"images",labelIdle:'Drag & Drop your images or <span class="filepond--label-action">Browse</span>',acceptedFileTypes:["image/png","image/jpeg","image/gif"],fileValidateTypeLabelExpectedTypes:"Expects PNG, JPG, or GIF",labelMaxFileSizeExceeded:"File is too large",labelMaxFileSize:"Maximum file size is {filesize}",credits:!1})}),w.images&&d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w.images}),Object.keys(w).map((e=>e.startsWith("images.")?d.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:w[e]},e):null))]}),d.jsxs("div",{className:"flex items-start space-x-6",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{id:"featured",type:"checkbox",checked:b.featured,onChange:e=>y("featured",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 rounded"}),d.jsx("label",{htmlFor:"featured",className:"ml-2 block text-sm text-cinematic-700 dark:text-cinematic-300",children:"Featured Product"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{id:"is_active",type:"checkbox",checked:b.is_active,onChange:e=>y("is_active",e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-cinematic-300 dark:border-cinematic-600 dark:bg-cinematic-700 rounded"}),d.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-cinematic-700 dark:text-cinematic-300",children:"Active"})]})]})]})]}),d.jsx("div",{className:"mt-8 pt-5 border-t border-cinematic-200 dark:border-cinematic-700",children:d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{type:"submit",disabled:N,className:"ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 dark:bg-primary-700 dark:hover:bg-primary-600",children:N?"Saving...":h?"Update Product":"Create Product"})})})]})})}),d.jsx("style",{jsx:"true",global:"true",children:"\n        .filepond--panel-root {\n            background-color: #374151; // Corresponds to dark:bg-cinematic-700 or similar\n            border: 1px dashed #4B5563; // Corresponds to dark:border-cinematic-600 or similar\n        }\n        .filepond--drop-label label {\n            color: #D1D5DB; // Corresponds to dark:text-cinematic-300 or similar\n        }\n        .filepond--label-action {\n            text-decoration-color: #9CA3AF;\n        }\n        .filepond--file-action-button {\n            color: #D1D5DB;\n        }\n        .filepond--file-info-main, .filepond--file-info-sub {\n            color: #D1D5DB;\n        }\n        .filepond--item-panel {\n            background-color: #4B5563;\n        }\n        /* Add more specific FilePond dark theme overrides if needed */\n      "})]})};export{y as default};
